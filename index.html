<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>수학 퀴즈 앱</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
            max-width: 600px;
            width: 100%;
            text-align: center;
        }

        .title {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .menu {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .menu-button {
            background-color: #5a2e9b;
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            font-size: 1.1em;
            transition: transform 0.2s ease, background-color 0.2s ease;
        }

        .menu-button:hover {
            background-color: #4a257e;
            transform: translateY(-2px);
        }

        .quiz-section {
            display: none;
            text-align: left;
        }

        .question-box {
            background: #f7f7f7;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .question-text {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
        }

        .answer-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            margin-bottom: 10px;
        }

        .feedback {
            font-weight: bold;
            font-size: 1.2em;
            margin-top: 10px;
            min-height: 25px;
        }

        .correct {
            color: #28a745;
        }

        .wrong {
            color: #dc3545;
        }

        .score-display {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
            margin-top: 20px;
        }

        .progress-bar-container {
            width: 100%;
            background-color: #eee;
            border-radius: 50px;
            margin-top: 15px;
        }

        .progress-bar {
            height: 15px;
            background-color: #5a2e9b;
            border-radius: 50px;
            transition: width 0.5s ease;
        }

        .about-section, .records-section {
            display: none;
            text-align: left;
            padding: 20px;
        }

        .record-item {
            background-color: #f0f0f0;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
        }
        
        .records-section h2, .about-section h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .input-field {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">수학 퀴즈 앱</h1>

        <div class="menu" id="mainMenu">
            <h2 class="section-title">수학 퀴즈에 도전해보세요!</h2>
            <label for="userName" style="font-weight: bold; margin-bottom: 5px; display: block;">퀴즈를 시작하기 전에 이름을 입력해주세요.</label>
            <input type="text" id="userName" placeholder="이름을 입력하세요" class="input-field">
            <button class="menu-button" onclick="beginQuiz()">퀴즈 시작</button>
            <button class="menu-button" onclick="showRecords()">기록 보기</button>
            <button class="menu-button" onclick="showAbout()">앱 정보</button>
        </div>

        <div class="quiz-section" id="quizView">
            <h2 id="quizTitle" class="section-title"></h2>
            <div class="progress-bar-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="question-box">
                <p id="questionText" class="question-text"></p>
                <input type="number" id="answerInput" class="answer-input" placeholder="정답을 입력하세요">
                <p id="feedback" class="feedback"></p>
                <button class="menu-button" onclick="checkAnswer()">정답 확인</button>
            </div>
            <div id="quizScore" class="score-display">점수: 0</div>
            <button class="menu-button" onclick="showMainMenu()">메인 메뉴로</button>
        </div>

        <div class="quiz-section" id="recordsView">
            <h2 class="section-title">퀴즈 기록</h2>
            <div id="recordsContainer"></div>
            <button class="menu-button" onclick="showMainMenu()">메인 메뉴로</button>
        </div>

        <div class="quiz-section" id="aboutView">
            <h2 class="section-title">앱 정보</h2>
            <p style="text-align: center; margin-bottom: 20px;">
                이 앱은 사용자의 수학 실력 향상을 위해 만들어졌습니다.<br>
                다양한 난이도와 유형의 문제에 도전해보세요!
            </p>
            <button class="menu-button" onclick="showMainMenu()">메인 메뉴로</button>
        </div>
    </div>

    <script>
        let currentQuestionIndex = 0;
        let score = 0;
        let quizQuestions = [];
        let userName = '';
        const records = JSON.parse(localStorage.getItem('quizRecords')) || [];
        const questionsPerQuiz = 10;
        let startTime;

        const allProblems = [
            { type: '덧셈', text: '100 + 50', answer: 150, grade: 'E' },
            { type: '덧셈', text: '75 + 25', answer: 100, grade: 'E' },
            { type: '덧셈', text: '35 + 15', answer: 50, grade: 'E' },
            { type: '덧셈', text: '42 + 58', answer: 100, grade: 'E' },
            { type: '덧셈', text: '23 + 67', answer: 90, grade: 'E' },
            { type: '뺄셈', text: '200 - 80', answer: 120, grade: 'E' },
            { type: '뺄셈', text: '90 - 45', answer: 45, grade: 'E' },
            { type: '뺄셈', text: '120 - 70', answer: 50, grade: 'E' },
            { type: '뺄셈', text: '78 - 34', answer: 44, grade: 'E' },
            { type: '뺄셈', text: '56 - 19', answer: 37, grade: 'E' },
            { type: '곱셈', text: '12 * 5', answer: 60, grade: 'E' },
            { type: '곱셈', text: '8 * 7', answer: 56, grade: 'E' },
            { type: '곱셈', text: '6 * 9', answer: 54, grade: 'E' },
            { type: '곱셈', text: '11 * 11', answer: 121, grade: 'E' },
            { type: '곱셈', text: '15 * 3', answer: 45, grade: 'E' },
            { type: '나눗셈', text: '100 / 10', answer: 10, grade: 'E' },
            { type: '나눗셈', text: '81 / 9', answer: 9, grade: 'E' },
            { type: '나눗셈', text: '49 / 7', answer: 7, grade: 'E' },
            { type: '나눗셈', text: '64 / 8', answer: 8, grade: 'E' },
            { type: '나눗셈', text: '144 / 12', answer: 12, grade: 'E' },
            { type: '혼합', text: '10 + 5 * 2', answer: 20, grade: 'E' },
            { type: '혼합', text: '20 / 4 + 3', answer: 8, grade: 'E' },
            { type: '혼합', text: '7 * 6 - 2', answer: 40, grade: 'E' },
            { type: '혼합', text: '12 - 3 * 2', answer: 6, grade: 'E' },
            { type: '혼합', text: '30 / 5 + 4', answer: 10, grade: 'E' },
            // Grade A 문제
            { type: '덧셈', text: '456 + 789', answer: 1245, grade: 'A' },
            { type: '뺄셈', text: '987 - 321', answer: 666, grade: 'A' },
            { type: '곱셈', text: '123 * 45', answer: 5535, grade: 'A' },
            { type: '나눗셈', text: '999 / 9', answer: 111, grade: 'A' },
            { type: '혼합', text: '15 * 5 - 20 / 4', answer: 70, grade: 'A' },
            // Grade B 문제
            { type: '덧셈', text: '587 + 912', answer: 1499, grade: 'B' },
            { type: '뺄셈', text: '845 - 293', answer: 552, grade: 'B' },
            { type: '곱셈', text: '24 * 36', answer: 864, grade: 'B' },
            { type: '나눗셈', text: '840 / 12', answer: 70, grade: 'B' },
            { type: '혼합', text: '100 / 5 + 10 * 3', answer: 50, grade: 'B' },
            // Grade C 문제
            { type: '덧셈', text: '352 + 481', answer: 833, grade: 'C' },
            { type: '뺄셈', text: '756 - 428', answer: 328, grade: 'C' },
            { type: '곱셈', text: '17 * 8', answer: 136, grade: 'C' },
            { type: '나눗셈', text: '150 / 6', answer: 25, grade: 'C' },
            { type: '혼합', text: '12 + 8 / 2', answer: 16, grade: 'C' },
            // Grade D 문제
            { type: '덧셈', text: '51 + 27', answer: 78, grade: 'D' },
            { type: '뺄셈', text: '93 - 45', answer: 48, grade: 'D' },
            { type: '곱셈', text: '6 * 13', answer: 78, grade: 'D' },
            { type: '나눗셈', text: '108 / 9', answer: 12, grade: 'D' },
            { type: '혼합', text: '3 * 4 + 5', answer: 17, grade: 'D' },
            // Grade S 문제 (최상급)
            { type: '덧셈', text: '9999 + 1', answer: 10000, grade: 'S' },
            { type: '뺄셈', text: '100000 - 1', answer: 99999, grade: 'S' },
            { type: '곱셈', text: '12345 * 6789', answer: 83810205, grade: 'S' },
            { type: '나눗셈', text: '987654 / 321', answer: 3076.803738, grade: 'S' },
            { type: '혼합', text: '(100 + 20) * 5 - (50 / 2)', answer: 575, grade: 'S' },
            // Grade F 문제 (아주 쉬운)
            { type: '덧셈', text: '1 + 1', answer: 2, grade: 'F' },
            { type: '뺄셈', text: '5 - 3', answer: 2, grade: 'F' },
            { type: '곱셈', text: '2 * 3', answer: 6, grade: 'F' },
            { type: '나눗셈', text: '10 / 2', answer: 5, grade: 'F' },
            { type: '혼합', text: '2 + 2 * 2', answer: 6, grade: 'F' },
        ];
        
        // 사용자가 선택한 난이도 (기본값 'E')
        let userGrade = localStorage.getItem('userGrade') || 'E';

        function showSection(sectionId) {
            document.querySelectorAll('.quiz-section').forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById(sectionId).style.display = 'block';
        }

        function showMainMenu() {
            document.querySelectorAll('.quiz-section').forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById('mainMenu').style.display = 'flex';
        }

        function beginQuiz() {
            userName = document.getElementById('userName').value;
            if (userName.trim() === '') {
                alert('이름을 입력해주세요!');
                return;
            }

            currentQuestionIndex = 0;
            score = 0;
            quizQuestions = generateQuizQuestions();
            startTime = new Date();
            updateQuizUI();
            showSection('quizView');
            document.getElementById('quizTitle').innerText = `${userName}님의 퀴즈`;
        }

        function generateQuizQuestions() {
            const filteredProblems = allProblems.filter(problem => problem.grade === userGrade);
            if (filteredProblems.length < questionsPerQuiz) {
                return filteredProblems.sort(() => 0.5 - Math.random());
            }
            return filteredProblems.sort(() => 0.5 - Math.random()).slice(0, questionsPerQuiz);
        }

        function updateQuizUI() {
            if (currentQuestionIndex < questionsPerQuiz) {
                const currentQuestion = quizQuestions[currentQuestionIndex];
                document.getElementById('questionText').innerText = currentQuestion.text;
                document.getElementById('answerInput').value = '';
                document.getElementById('feedback').innerText = '';
                document.getElementById('quizScore').innerText = `점수: ${score}`;

                // 프로그레스 바 업데이트
                const progress = (currentQuestionIndex / questionsPerQuiz) * 100;
                document.getElementById('progressBar').style.width = `${progress}%`;
            } else {
                endQuiz();
            }
        }

        function checkAnswer() {
            const userAnswer = parseFloat(document.getElementById('answerInput').value);
            const currentQuestion = quizQuestions[currentQuestionIndex];
            const feedbackElement = document.getElementById('feedback');
            
            if (userAnswer === currentQuestion.answer) {
                feedbackElement.innerText = '정답입니다! 😊';
                feedbackElement.className = 'feedback correct';
                score += 10;
            } else {
                feedbackElement.innerText = `아쉽네요. 정답은 ${currentQuestion.answer}입니다.`;
                feedbackElement.className = 'feedback wrong';
            }

            setTimeout(() => {
                currentQuestionIndex++;
                updateQuizUI();
            }, 1500);
        }

        function endQuiz() {
            const endTime = new Date();
            const timeTaken = Math.round((endTime - startTime) / 1000);
            const resultMessage = `${userName}님, 퀴즈가 끝났습니다! 총 ${score}점을 획득하셨습니다. ${timeTaken}초 걸렸습니다.`;
            alert(resultMessage);
            
            records.push({
                userName: userName,
                score: score,
                date: new Date().toLocaleDateString('ko-KR'),
                time: timeTaken,
                grade: userGrade
            });
            localStorage.setItem('quizRecords', JSON.stringify(records));

            showMainMenu();
            updateGradeDisplay();
        }

        function updateGradeDisplay() {
            const recentScores = records.filter(record => record.userName === userName);
            if (recentScores.length > 0) {
                const latestRecord = recentScores[recentScores.length - 1];
                document.getElementById('quizTitle').innerText = `${userName}님의 최근 점수: ${latestRecord.score}점`;
            }
        }

        function showRecords() {
            showSection('recordsView');
            const recordsContainer = document.getElementById('recordsContainer');
            if (records.length === 0) {
                recordsContainer.innerHTML = '<p>아직 퀴즈 기록이 없습니다.</p>';
                return;
            }
            const sortedRecords = records.sort((a, b) => b.score - a.score);
            recordsContainer.innerHTML = sortedRecords.map((record, index) => `
                <div class="record-item">
                    <strong>${index + 1}. ${record.userName}</strong><br>
                    점수: ${record.score}점<br>
                    걸린 시간: ${record.time}초<br>
                    난이도: ${record.grade}
                </div>
            `).join('');
        }

        function showAbout() {
            showSection('aboutView');
        }

        // 초기화
        showMainMenu();
    </script>
</body>
</html>
